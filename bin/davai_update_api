#!/usr/bin/env python3
# -*- coding:Utf-8 -*-
"""
Update Davai API.
"""
from __future__ import print_function, absolute_import, unicode_literals, division

import os
import subprocess
import argparse

DAVAI_RC = os.path.join(os.environ['HOME'], '.davairc')
DAVAI_API_LOCAL_REPO = os.environ.get('DAVAI_API_LOCAL_REPO',
                                      os.path.join(DAVAI_RC, 'davai_api'))


def main(local_repo=DAVAI_API_LOCAL_REPO):
    os.chdir(local_repo)
    print("In '{}':".format(local_repo))
    subprocess.check_call(['git', 'fetch'])
    subprocess.check_call(['git', 'checkout', 'master'])
    subprocess.check_call(['git', 'pull', 'origin', 'master', '--ff-only'])


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description="Update Davai API.")
    parser.add_argument('-r', '--local_repository',
                        help="local repository to update; defaults to '{}'".format(DAVAI_API_LOCAL_REPO),
                        default=DAVAI_API_LOCAL_REPO)
    args = parser.parse_args()

    main(args.local_repository)

